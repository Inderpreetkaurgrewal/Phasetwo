CREATE TABLE EMPLOYEE(EMPID INT, EMPNAME VARCHAR(50),DEPARTMENT CHAR(10), CONTACTNO INT, EMAILID CHAR(50), EMPHEADID INT)
CREATE TABLE  EMPSALARY(EMPID INT, SALARY MONEY,ISPERMANENT VARCHAR(4))
CREATE TABLE EMPPROJECT(EMPID INT,PROJECTID CHAR(6),CLIENTID CHAR(8), STARTYEAR DATE, ENDYEAR DATE)
CREATE TABLE EMPDEPT(DEPTID CHAR(10), DEPTNAME VARCHAR(50), DEPT_OFF CHAR(12), DEPTHEAD INT)

INSERT INTO EMPLOYEE(EMPID, EMPNAME, DEPARTMENT,CONTACTNO, EMAILID,EMPHEADID)
VALUES
(101,'Vipanjot','E-101',1235765879,'vipan@gmail.com', 105),
(102,'Aman','E-104',1235765843,'amn@gmail.com', 103),
(103,'Jasleen','E-101',1235764459,'jasleen@gmail.com', 101),
(104,'Husan','E-102',1235743870,'husn@gmail.com', 105),
(105,'Isha','E-101',1235766484,'isha@gmail.com', 103);

INSERT INTO EMPSALARY(EMPID, SALARY, ISPERMANENT)
VALUES
(101,2000,'YES'),
(102,10000,'YES'),
(103,5000,'NO'),
(104,1900,'YES'),
(105,2300,'YES');

INSERT INTO EMPPROJECT(EMPID, PROJECTID,CLIENTID,STARTYEAR,ENDYEAR)
VALUES
(101,'p-1','cl-1','2010','2010'),
(102,'p-2','cl-2','2010','2012'),
(103,'p-1','cl-3','2013',''),
(104,'p-4','cl-1','2014','2015'),
(105,'p-4','cl-5','2015','');

INSERT INTO EMPDEPT(DEPTID,DEPTNAME,DEPT_OFF,DEPTHEAD)
VALUES
('E-101','HR','MONDAY',105),
('E-102','DEVELOPMENT','TUESDAY', 101),
('E-103','HOUSE KEEPING','SATURDAY', 103),
('E-104','SALES','SUNDAY', 104),
('E-105','PURCHASE','TUESDAY' ,104);

SELECT * FROM EMPLOYEE;
SELECT * FROM EMPSALARY;
SELECT * FROM EMPPROJECT;
SELECT * FROM EMPDEPT;

--1)
SELECT * FROM EMPLOYEE
WHERE EMPNAME LIKE 'A%';

--2)
SELECT COUNT(SALARY) AS 'TOTAL EMPLOYEES'
FROM EMPSALARY 
WHERE ISPERMANENT = 'YES' AND SALARY > 4000;

--3)
SELECT * FROM EMPLOYEE
WHERE DEPARTMENT = 'E-102' OR DEPARTMENT = 'E-104';

--4) 
SELECT SUM(SALARY) AS 'TOTAL SALARY OF PERMANENT EMPLOYEES'
FROM  EMPSALARY
WHERE ISPERMANENT = 'YES';

--5)
SELECT COUNT(PROJECTID)
FROM EMPPROJECT
WHERE STARTYEAR = '2010'


--6)
SELECT DEPTNAME FROM EMPDEPT WHERE DEPTID IN(SELECT DEPARTMENT FROM EMPLOYEE
WHERE EMPID > 104);

--7)
SELECT EMPNAME FROM EMPLOYEE 
WHERE EMPID IN
(SELECT EMPID 
FROM EMPLOYEE)
AND EMPID IN(SELECT EMPID 
FROM EMPSALARY 
WHERE ISPERMANENT = 'YES');


--8)
SELECT * FROM EMPLOYEE
WHERE DEPARTMENT IN
(SELECT DEPTID FROM EMPDEPT WHERE DEPT_OFF = 'MONDAY');



--question2)
CREATE TABLE STUDENT( ID INT, NAME VARCHAR(50) NOT NULL, GENDER VARCHAR(10),DOB datetime,)
 INSERT INTO STUDENT(ID,NAME,GENDER,DOB)
 VALUES
(200425741,'VIPANJOT', 'FEMALE','2001-01-14'),
(200425674,'HUSANPREET','FEMALE' ,'1999-08-14'),
(200425785,'JASLEEN', 'FEMALE',  '1999-07-05'),
(200467863,'JASMEET','MALE' ,  '2000-10-25'),
(200426794,'MUSKAN', 'FEMALE','2000-12-21');

USE ASSIGNMENT1
GO

CREATE FUNCTION BornBefore(@DOB AS DATETIME)
RETURNS TABLE
AS
RETURN(SELECT * FROM STUDENT
		WHERE DOB < @DOB)

SELECT * FROM BornBefore('2000-10-25');


--question 3)
CREATE FUNCTION sc_sum(@p1 int,@p2 int,@p3 int)
RETURNS INT
AS
BEGIN
DECLARE @result int
SET @result = @p1 + @p2+@p3 
RETURN @result
END

SELECT DBO.sc_sum(20,5,10);